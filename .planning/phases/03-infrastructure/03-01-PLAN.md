---
phase: 03-infrastructure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - astro.config.mjs
  - public/icon-192.png
  - public/icon-512.png
autonomous: true

must_haves:
  truths:
    - "PWA manifest shows justcarlson.com branding"
    - "PWA install prompt shows Just Carlson name and description"
    - "PWA icons display JC monogram at all sizes"
  artifacts:
    - path: "astro.config.mjs"
      provides: "PWA manifest configuration"
      contains: "name: \"Just Carlson\""
    - path: "public/icon-192.png"
      provides: "192x192 PWA icon"
      min_bytes: 1000
    - path: "public/icon-512.png"
      provides: "512x512 PWA icon"
      min_bytes: 1000
  key_links:
    - from: "astro.config.mjs"
      to: "public/icon-192.png"
      via: "manifest icons array"
      pattern: "icon-192\\.png"
---

<objective>
Update PWA manifest to Just Carlson branding and generate required icon sizes.

Purpose: PWA manifest currently shows "Peter Steinberger" and references "peter-avatar.jpg". Update to Just Carlson identity and ensure all required icon sizes exist for proper PWA installation.

Output: Updated astro.config.mjs with correct manifest values and 192x192/512x512 icon files.
</objective>

<execution_context>
@/home/jc/.claude/get-shit-done/workflows/execute-plan.md
@/home/jc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-infrastructure/03-RESEARCH.md

Current state:
- astro.config.mjs lines 100-172 have PWA config with Peter's branding
- public/apple-touch-icon.png is 180x180 (too small for PWA 192x192/512x512 requirements)
- public/favicon.svg has JC monogram with theme-adaptive colors
- SITE.desc in consts.ts is the authoritative description
</context>

<tasks>

<task type="auto">
  <name>Task 1: Generate PWA icon sizes from favicon</name>
  <files>public/icon-192.png, public/icon-512.png</files>
  <action>
Use sharp (already installed) to generate PWA-compliant icons from the existing favicon source.

Create a one-off script that:
1. Reads public/favicon.svg (JC monogram with background)
2. Renders to 192x192 PNG as public/icon-192.png
3. Renders to 512x512 PNG as public/icon-512.png

Both icons should use the dark background (#222222) to match favicon.ico style for app icon contexts.

Run the script via node to generate the icons, then delete the script.

Verify: `file public/icon-192.png public/icon-512.png` shows correct dimensions (192x192 and 512x512).
  </action>
  <verify>file public/icon-192.png && file public/icon-512.png && identify public/icon-192.png | grep "192x192" && identify public/icon-512.png | grep "512x512"</verify>
  <done>192x192 and 512x512 PNG icons exist with JC monogram</done>
</task>

<task type="auto">
  <name>Task 2: Update PWA manifest configuration</name>
  <files>astro.config.mjs</files>
  <action>
Update the AstroPWA manifest configuration (lines 100-172) with Just Carlson branding:

1. Change `name` from "Peter Steinberger" to "Just Carlson"
2. Change `short_name` from "steipete" to "JustCarlson"
3. Update `description` to match SITE.desc (import from consts.ts or use equivalent: "Writing about things I find interesting")
4. Update `includeAssets` from ["favicon.ico", "peter-avatar.jpg"] to ["favicon.ico", "apple-touch-icon.png"]
5. Update `icons` array:
   - Keep favicon.ico entry (48x48)
   - Replace peter-avatar.jpg 192x192 with icon-192.png (PNG, purpose: any)
   - Replace peter-avatar.jpg 512x512 with icon-512.png (PNG, purpose: any maskable)

Keep theme_color (#006cac) and background_color (#fdfdfd) as they are appropriate.
Keep all workbox, devOptions, and experimental settings unchanged.
  </action>
  <verify>grep -E "(Just Carlson|JustCarlson|icon-192\.png|icon-512\.png)" astro.config.mjs</verify>
  <done>PWA manifest shows Just Carlson branding and references new icons</done>
</task>

</tasks>

<verification>
1. Run `npm run build` and check for PWA errors
2. Check generated manifest in dist/manifest.webmanifest contains Just Carlson branding
3. Verify no references to "Peter Steinberger", "steipete", or "peter-avatar" in astro.config.mjs
</verification>

<success_criteria>
- PWA manifest in astro.config.mjs has name="Just Carlson", short_name="JustCarlson"
- Icon files icon-192.png and icon-512.png exist with correct dimensions
- Build completes without PWA-related errors
- Generated manifest.webmanifest shows correct branding
</success_criteria>

<output>
After completion, create `.planning/phases/03-infrastructure/03-01-SUMMARY.md`
</output>

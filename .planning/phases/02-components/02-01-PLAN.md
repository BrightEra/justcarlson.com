---
phase: 02-components
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/StructuredData.astro
  - src/components/BaseHead.astro
autonomous: true

must_haves:
  truths:
    - "BlogPosting schema shows Justin Carlson as author"
    - "Person schema shows justcarlson.com identity"
    - "WebSite schema references justcarlson.com domain"
    - "No hardcoded steipete or Peter Steinberger references in structured data"
    - "PWA meta tags show site title from config"
  artifacts:
    - path: "src/components/StructuredData.astro"
      provides: "Schema.org JSON-LD for SEO"
      contains: "SITE.author"
    - path: "src/components/BaseHead.astro"
      provides: "PWA meta tags using config"
      contains: "SITE.title"
  key_links:
    - from: "src/components/StructuredData.astro"
      to: "src/consts.ts"
      via: "import { SITE, SOCIAL_LINKS }"
      pattern: "import.*SITE.*from.*consts"
    - from: "src/components/BaseHead.astro"
      to: "src/consts.ts"
      via: "import { SITE }"
      pattern: "import.*SITE.*from.*consts"
---

<objective>
Update StructuredData.astro and BaseHead.astro to consume SITE config values instead of hardcoded references.

Purpose: Structured data (JSON-LD) is what Google and other search engines read to understand site authorship and content. PWA meta tags define how the site appears when installed as an app. Both currently have hardcoded values.

Output: StructuredData.astro consuming SITE.author, SITE.website, SITE.desc, and SOCIAL_LINKS from consts.ts. BaseHead.astro PWA meta tags using SITE.title.
</objective>

<execution_context>
@/home/jc/.claude/get-shit-done/workflows/execute-plan.md
@/home/jc/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-components/02-CONTEXT.md
@.planning/phases/02-components/02-RESEARCH.md

# Key source files
@src/consts.ts
@src/components/StructuredData.astro
@src/components/BaseHead.astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Refactor StructuredData.astro to use config values</name>
  <files>src/components/StructuredData.astro</files>
  <action>
Rewrite StructuredData.astro to import and use SITE and SOCIAL_LINKS from consts.ts:

1. Add imports at top of frontmatter:
   ```typescript
   import { SITE, SOCIAL_LINKS } from "@/consts";
   ```

2. Update BlogPosting schema:
   - author.name: `data.author || SITE.author`
   - author.url: `SITE.profile`
   - publisher.name: `SITE.author`
   - publisher.logo.url: `new URL("/apple-touch-icon.png", SITE.website).href` (use existing apple-touch-icon as avatar)
   - image fallback: `new URL("/og.png", SITE.website).href`

3. Update Person schema:
   - name: `SITE.author`
   - url: `SITE.website`
   - image: `new URL("/apple-touch-icon.png", SITE.website).href`
   - sameAs: `SOCIAL_LINKS.filter(s => s.label !== "RSS").map(s => s.href)`
   - description: `SITE.desc`

4. Update WebSite schema:
   - name: `SITE.author`
   - url: `SITE.website`
   - description: `SITE.desc`
   - author.name: `SITE.author`
   - potentialAction.target: Template with `${SITE.website}search?q={search_term_string}`

Remove ALL hardcoded references:
- "Peter Steinberger"
- "steipete.me"
- "steipete"
- "peter-avatar.jpg"
- Any social URLs (github.com/steipete, twitter.com/steipete, etc.)

Keep using JSON.stringify() with set:html for XSS safety.
  </action>
  <verify>
Run: `rg -i "steipete|peter" src/components/StructuredData.astro`
Should return no matches.

Run: `rg "SITE\." src/components/StructuredData.astro`
Should show multiple config references.
  </verify>
  <done>
StructuredData.astro uses SITE.author, SITE.website, SITE.profile, SITE.desc, and SOCIAL_LINKS from consts.ts. Zero hardcoded identity references remain.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update BaseHead.astro PWA meta tags to use config</name>
  <files>src/components/BaseHead.astro</files>
  <action>
Update the hardcoded PWA meta tags on lines 41-42 to use SITE.title:

Current (hardcoded):
```html
<meta name="apple-mobile-web-app-title" content="Just Carlson" />
<meta name="application-name" content="Just Carlson" />
```

Change to (config-driven):
```html
<meta name="apple-mobile-web-app-title" content={SITE.title} />
<meta name="application-name" content={SITE.title} />
```

SITE is already imported on line 3, so no new imports needed.
  </action>
  <verify>
Run: `rg "apple-mobile-web-app-title|application-name" src/components/BaseHead.astro`
Should show both meta tags using `{SITE.title}` syntax, not hardcoded strings.
  </verify>
  <done>
BaseHead.astro PWA meta tags use SITE.title from config instead of hardcoded values.
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify structured data renders correctly</name>
  <files>src/components/StructuredData.astro</files>
  <action>
Build the site and verify structured data output programmatically:

1. Run: `npm run build`
2. Check the built index.html for correct structured data

The verification will confirm:
- WebSite schema shows "Just Carlson" (or "Justin Carlson") and justcarlson.com
- No steipete/Peter references in any JSON-LD
  </action>
  <verify>
Run: `npm run build && rg -A10 'application/ld\+json' dist/index.html | rg -i 'carlson|justcarlson'`
Should show matches confirming Justin Carlson identity in structured data.

Run: `rg -A10 'application/ld\+json' dist/index.html | rg -i 'steipete|peter'`
Should return no matches.
  </verify>
  <done>
Build passes. Structured data JSON-LD in built HTML shows Justin Carlson identity. No Peter/steipete references remain.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. Grep verification (no old references):
   ```bash
   rg -i "steipete|peter steinberger" src/components/StructuredData.astro
   ```
   Expected: No matches

2. Config usage verification:
   ```bash
   rg "SITE\." src/components/StructuredData.astro
   ```
   Expected: Multiple matches showing config consumption

3. BaseHead PWA tags verification:
   ```bash
   rg "SITE.title" src/components/BaseHead.astro
   ```
   Expected: Matches for PWA meta tags

4. Build verification:
   ```bash
   npm run build && rg -A10 'application/ld\+json' dist/index.html | rg -i 'carlson'
   ```
   Expected: Build succeeds, structured data shows correct identity
</verification>

<success_criteria>
- StructuredData.astro imports SITE and SOCIAL_LINKS from consts.ts
- All three schema types (BlogPosting, Person, WebSite) use config values
- Zero hardcoded steipete/Peter references remain in the component
- BaseHead.astro PWA meta tags use SITE.title
- Build passes successfully
- Built HTML contains correct identity in structured data
</success_criteria>

<output>
After completion, create `.planning/phases/02-components/02-01-SUMMARY.md`
</output>
